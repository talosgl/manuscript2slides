# Conceptual Trees
`├ └ │ ─`

# collapsed
root (main UI window)
└── ttk Notebook container
|  ├── docx2pptx tab frame
|  ├── pptx2docx tab frame
|  └── demo tab frame
└── Log Viewer Frame (should be visible from all tabs)
    ├── Text window
    └── Clear button

# one more level
docx2pptx tab frame
├── I/O Selection frame
├── Options Frame
└── Action Frame

pptx2docx tab frame
├── I/O Selection frame
├── Options Frame
└── Action Frame

demo tab frame
└── Select Demo frame


# Two more levels
docx2pptx tab frame
├── I/O Selection frame
|   ├── Input File Selector* (docx)
|   └── Hidden Frame
|       ├── Output folder Selector*
|       └── Custom Template Selector* (pptx)
├── Options Frame
|   ├── Basic Options Frame
|   |    ├── Chunk Type Dropdown
|   |    └── Experimental Formatting on
|   └── Advanced Options Frame
|       ├── Preserve metadata in speaker notes for reverse pipeline 
|       ├── Annotations in Speaker Notes parent toggle + children
|       └── Save/Load Config file
└── Action Frame
    ├── Convert button
    └── Status Indicator

----
* Could have a file selector class that takes in args:
    - file types
    - Label/Frame name
    - selected default | None
----


pptx2docx tab frame
├── I/O Selection frame
|   ├── Input File Selector (pptx)
|   └── Hidden Frame
|       ├── Output folder Selector
|       └── Custom Template Selector (docx)
├── Options Frame
|   └── Basic Options Frame
|       └── Save/Load Config**
└── Action Frame
    ├── Convert button
    └── Status Indicator


----
** There aren't really options atm for the reverse pipeline but we can put something in the UI for later.
----


demo tab frame
└── Select Demo frame
    ├── docx2pptx demo button
    ├── pptx2docx demo button
    ├── round trip demo button
    └── load config and run demo button

-----------------

# Code structure Tree(s)

class MainWindow(tk.Tk)
├── init constructor
|   ├── set values that need to be set
|   |   ├── call parent class init to set root, title
|   |   └── set shared state (e.g., shared cancel bool flag)
|   ├── call _apply_theme()
|   └── call _create_widgets()
├── define _apply_theme()
└── define _create_widgets()
    ├── create the ttk.notebook (doesn't need a class)
    ├── populate the notebook's tabs
    |   ├── create docx2pptx tab frame (call its class init)
    |   ├── create pptx2docx tab frame
    |   ├── create demo tab frame
    |   └── add all 3 tabs to the notebook so they're visible (notebook.add(..))
    └── create/call the log viewer frame

class Docx2PptxTab(ttk.Frame)
├── def init constructor
|   ├── super().__init__(parent)
|   ├── self.log_viewer = log_viewer  # Store reference
|   └── self._create_widgets()
└── define _create_widgets()
|   ├── Create IO Frame
|   |   ├── create input_file_selector: PathSelector()
|   |   └── Create (Collapsible) Advanced IO frame
|   |       ├── output_selector: PathSelector()
|   |       └── template_selector: PathSelector()
|   ├── Create Options Frame
|   |   ├── Basic Options frame
|   |   |   ├── Chunk Type Dropdown/combobox
|   |   |   └── Experimental Formatting bool
|   |   └── Advanced Options frame (collapsible)
|   |       ├── annotations master toggle frame
|   |       |   ├── 3 bools
|   |       |   └── ...
|   |       └── create SaveLoadConfig with on_save=set_config, on_load=get_config
|   └── Create Action Frame
├── def on_convert_click(self)  
├── def _run_conversion_thread(self, cfg)
├── def ui_to_config()
└── def config_to_ui()

class CollapsibleFrame(ttk.Frame) # tk and ttk don't have native collapsible frames
├── def __init__(self, parent: tk.Widget, title: str, start_collapsed: bool = True)
└── def toggle()

class PathSelector(ttk.Frame)
├── def __init__(self, parent, label, is_dir=False, filetypes=None, default=None)
|   ├── super().__init__(parent)  ← Makes this Frame exist
|   |── self.is_dir = is_dir
|   ├── self.label_text = label
|   ├── self.filetypes = filetypes  
|   ├── self.default = default
|   ├── self.selected_path = tk.StringVar(...)
|   └── self._create_widgets()  ← Builds the internals
├── def browse() # callbacks are conventionally public even if only internally referenced
└── def _create_widgets(self)
    ├── create label widget (and grid/pack it inside self)
    ├── create entry widget (and grid/pack it inside self)
    └── create browse button, with browse as callback (and grid/pack it inside self)

class SaveLoadConfig(ttk.Frame)
├── def __init__
|   ├── super stuff
|   ├── self.on_save = on_save  # Callback to get config
|   ├── self.on_load = on_load  # Callback to set config
|   └── self._create_widgets()
├── def _create_widgets()
|   ├── Save Button
|   └── Load Button
├── def on_save_click
|   └── browse for location and then save
└── def on_load_click
    └── browse for location and then load into UI/populate fields

class ActionFrame(ttk.Frame)
├── def init
|   ├── self.on_convert = on_convert # Callback from parent
|   ├── call create widget
├── def _create_widgets()
|   ├── Convert button
|   └── Status Indicator
├── def set_status
├── def disable_convertbtn
└── def enable_convertbtn

class Pptx2DocxTab(ttk.Frame)
├── init constructor
├── call _create_widgets()
├── def _create_widgets
|   ├── Create IO Frame
|   |   ├── create input_file_selector: PathSelector()
|   |   └── Create (Collapsible) Advanced IO frame
|   |       ├── output_selector: PathSelector()
|   |       └── template_selector: PathSelector()
|   ├── Create Options Frame
|   |    └── create SaveLoadConfig with on_save=set_config, on_load=get_config
|   └── ActionFrame
├── def on_convert_click(self)  # The callback ActionFrame calls
├── def _run_conversion_thread(self, cfg)  # The threaded worker
├── def ui_to_config()
└── def config_to_ui()

class DemoTab(ttk.Frame)
├── def __init__(self, parent)
|   ├── super().__init__(parent)
|   └── self._create_widgets()
└── def _create_widgets()
    ├── Demo Selection Frame
    |   ├── Button: "DOCX → PPTX Demo" (command=self.run_docx2pptx_demo)
    |   ├── Button: "PPTX → DOCX Demo" (command=self.run_pptx2docx_demo)
    |   ├── Button: "Round-trip Demo" (command=self.run_roundtrip_demo)
    |   └── Separator
    |   └── Button: "Load Config & Run" (command=self.run_custom_demo)
    ├── def run_docx2pptx_demo(self)
    |   └── Load pre-baked config, run pipeline
    ├── def run_pptx2docx_demo(self)
    ├── def run_roundtrip_demo(self)
    └── def run_custom_demo(self)
        └── Browse for .toml, load it, run pipeline

class LogViewer(LabelFrame)
├── def __init__(self, parent)
|   ├── super().__init__(parent, text="Log Viewer")
|   ├── self._create_widgets()
|   └── self._setup_logging()
├── def _create_widgets()
|   ├── self.text_widget = scrolledtext.ScrolledText(...)
|   └── self.clear_btn = ttk.Button(..., command=self.clear)
├── def _setup_logging(self)
|   └── Create TextWidgetHandler, attach to 'manuscript2slides' logger
├── def clear(self)
|   └── Delete all text from text_widget
└── def _auto_scroll(self)
    └── text_widget.see('end')

class TextWidgetHandler(logging.Handler)
├── def __init__(self, text_widget)
|   ├── super().__init__()
|   └── self.text_widget = text_widget
├── def emit(self, record)
|   └── Format record, use .after() to call _append (thread-safe)
└── def _append(self, msg)
    └── Insert msg into text_widget, auto-scroll

def main():
    app = MainWindow()  # Creates the window
    app.mainloop()      # Starts the event loop

Helper methods:
def show_completion_dialog(output_folder)
def open_folder_in_os_explorer(folder_path)