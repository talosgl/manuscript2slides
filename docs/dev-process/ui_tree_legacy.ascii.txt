# Conceptual Trees
`├ └ │ ─`

# collapsed
root (main UI window)
└── ttk Notebook container
|  ├── docx2pptx tab frame
|  ├── pptx2docx tab frame
|  └── demo tab frame
└── Log Viewer Frame (should be visible from all tabs)
    ├── Text window
    └── Clear button

# one more level
docx2pptx tab frame
├── I/O Selection frame
├── Options Frame
└── Action Frame
└── (Shared Log Viewer Frame)

pptx2docx tab frame
├── I/O Selection frame
└── Action Frame
└── (Shared Log Viewer Frame)

demo tab frame
└── Select Demo frame
└── (Shared Log Viewer Frame)

# Two more levels
docx2pptx tab frame
├── I/O Selection frame
|   ├── Input File Selector* (docx)
|   └── Hidden Frame
|       ├── Output folder Selector*
|       ├── Custom Template Selector* (pptx)
|       └── Save/Load Config file
├── Options Frame
|   ├── Basic Options Frame
|   |    ├── Chunk Type Dropdown
|   |    └── Experimental Formatting on
|   └── Advanced Options Frame
|       ├── Preserve metadata in speaker notes for reverse pipeline 
|       └──  Annotations in Speaker Notes parent toggle + children
└── Action Frame
    ├── Convert button
    └── Status Indicator

----
* File selector class that takes in args:
    - file types
    - Label/Frame name
    - selected default | None
----


pptx2docx tab frame
├── I/O Selection frame
|   ├── Input File Selector (pptx)
|   └── Hidden Frame
|       ├── Output folder Selector
|       ├── Custom Template Selector (docx)
|       └── Save/Load Config**
├── Options Frame (unused)
|       
└── Action Frame
    ├── Convert button
    └── Status Indicator


----
** There aren't really options atm for the reverse pipeline but we can put something in the UI for later.
----


demo tab frame
└── Select Demo frame
    ├── docx2pptx demo button
    ├── pptx2docx demo button
    ├── round trip demo button
    └── load config and run demo button

-----------------

# Code structure Tree(s)

class MainWindow(tk.Tk)
├── init constructor
|   ├── set values that need to be set
|   |   ├── call parent class init to set root, title
|   |   └── set shared state (e.g., shared cancel bool flag)
|   ├── call _apply_theme()
|   └── call _create_widgets()
├── define _apply_theme()
└── define _create_widgets()
    ├── create the ttk.notebook (doesn't need a component)
    ├── populate the notebook's tabs
    |   ├── create docx2pptx tab frame (call its class init)
    |   ├── create pptx2docx tab frame
    |   ├── create demo tab frame
    |   └── add all 3 tabs to the notebook so they're visible (notebook.add(..))
    └── create/call the log viewer frame

## Tab Classes

### Parent Classes
class BaseConversionTab(ttk.Frame)
├── def init constructor
└── def all the methods shared by all three tabs
    ├── _create_convert_button() # ignored by DemoTab
    ├── _load_config() # load a config from file but don't do anything with it (child class will call/implement)
    ├── start_conversion() # disable buttons and start conversion background thread
    ├── disable_buttons
    ├── enable_buttons
    ├── _run_in_thread()
    ├── _on_conversion_success
    └── _on_conversion_error

class ConfigurableConversionTab(BaseConversionTab)
├── def init constructor
└── def all the methods shared by docx2pptx and pptx2docx tabs
    ├── (first, abstract methods children must implement)
    ├── ui_to_config
    ├── config_to_ui
    ├── get_pipeline_direction()
    ├── _validate_input
    ├── (then, concrete, shared behavior methods)
    ├── _create_action_section
    ├── _on_file_selected
    ├── on_convert_click
    ├── on_save_config_click
    ├── on_load_config_click
    └── _validate_loaded_config


## Child classes
class Docx2PptxTab(ttk.Frame)
├── def init constructor
|   ├── super().__init__(parent)
|   ├── (other tab-specific vars)
|   └── self._create_widgets()
├── def _create_widgets()
|   ├── calls create io_frame, basic options, and advanced options from self
|   └── calls create action frame defined on parent
├── def Create IO Frame
|   ├── create input_file_selector: PathSelector()
|   ├── Create (Collapsible) Advanced IO frame
|   |   ├── output_selector: PathSelector()
|   |   └── template_selector: PathSelector()
|   └── Create Save/Load buttons
├── def Basic Options frame
|   ├── Chunk Type Dropdown/combobox
|   ├── Collapsible chunk type explanation
|   └── Experimental Formatting bool
├── def Advanced Options frame (collapsible)
|   ├── preserve_docx_metadata_in_speaker_notes
|   └── annotations master toggle frame
|       └── 3 child bools
├── def _setup_annotation_observers
├── def _on_child_annotation_changed
├── def _on_parent_annotation_changed
├── def ui_to_config()
├── def config_to_ui()
├── _get_input_path
├── get_pipeline_direction
└── _validate_input

class Pptx2DocxTab(ttk.Frame)
├── def init constructor
|   ├── super().__init__(parent)
|   ├── (other tab-specific vars)
|   └── self._create_widgets()
├── def _create_widgets()
|   ├── calls create io_frame
|   └── calls create action frame defined on parent
├── def Create IO Frame
|   ├── create input_file_selector: PathSelector()
|   ├── Create (Collapsible) Advanced IO frame
|   |   ├── output_selector: PathSelector()
|   |   └── template_selector: PathSelector()
|   └── Create Save/Load buttons
├── (UNUSED) def create_options()
├── def ui_to_config()
├── def config_to_ui()
├── _get_input_path
├── get_pipeline_direction
└── _validate_input


class DemoTab(BaseConversionTab)
├── def __init__(self, parent)
|   ├── super().__init__(parent)
|   └── self._create_widgets()
└── def _create_widgets()
    ├── Demo Selection Frame
    |   ├── Button: "DOCX → PPTX Demo" (command=self.on_docx2pptx_demo_click)
    |   ├── Button: "PPTX → DOCX Demo" (command=self.on_pptx2docx_demo_click)
    |   ├── Button: "Round-trip Demo" (command=self.on_roundtrip_demo_click)
    |   └── Button: "Load Config & Run" (command=self.on_load_demo_click)
    ├── def on_docx2pptx_demo_click(self)
    |   └── Load pre-baked config, run pipeline
    ├── def on_pptx2docx_demo_click(self)
    ├── def on_roundtrip_demo_click(self)
    └── def on_load_demo_click(self)
        └── Browse for .toml, load it, run pipeline

## Component Classes

class CollapsibleFrame(ttk.Frame) # tk and ttk don't have native collapsible frames
├── def __init__(self, parent: tk.Widget, title: str, start_collapsed: bool = True)
└── def toggle()

class PathSelector(ttk.Frame)
├── def __init__(self, parent, label, is_dir=False, filetypes=None, default=None)
|   ├── super().__init__(parent)  ← Makes this Frame exist
|   |── self.is_dir = is_dir
|   ├── self.label_text = label
|   ├── self.filetypes = filetypes  
|   ├── self.default = default
|   ├── self.selected_path = tk.StringVar(...)
|   └── self._create_widgets()  ← Builds the internals
├── def browse() # callbacks are conventionally public even if only internally referenced
└── def _create_widgets(self)
    ├── create label widget (and grid/pack it inside self)
    ├── create entry widget (and grid/pack it inside self)
    └── create browse button, with browse as callback (and grid/pack it inside self)

class LogViewer(LabelFrame)
├── def __init__(self, parent)
|   ├── super().__init__(parent, text="Log Viewer")
|   ├── self._create_widgets()
|   └── self._setup_logging()
├── def _create_widgets()
|   ├── self.text_widget = scrolledtext.ScrolledText(...)
|   └── self.clear_btn = ttk.Button(..., command=self.clear)
├── def _setup_log_handler(self)
|   └── Create TextWidgetHandler, attach to 'manuscript2slides' logger
├── def clear_log(self)
|   └── Delete all text from text_widget
└── def _auto_scroll(self)
    └── text_widget.see('end')

class TextWidgetHandler(logging.Handler)
├── def __init__(self, text_widget)
|   ├── super().__init__()
|   └── self.text_widget = text_widget
├── def emit(self, record) # implmenting from LogRecord parent class
|   └── Format record, use .after() to call _append (thread-safe)
└── def _append_log(self, msg)
    └── Insert msg into text_widget, auto-scroll

Helper methods:
def browse_for_file(
    title: str,
    filetypes: list[tuple[str, str]] | None = None,
    initial_dir: str | None = None,
)
def open_folder_in_os_explorer(folder_path)

def main():
    initialize_application()  # configure the log & other startup tasks
    log.info("Initializing Tkinter UI")
    app = MainWindow()  # Creates the window
    app.mainloop()      # Starts the event loop
